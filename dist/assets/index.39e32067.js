import{o as l,c as A,u as I,R as U,a as u,t as d,r as k,b as r,w as N,d as b,v as S,e as x,p as v,f as T,g as m,h as g,i as R,F as C,j as q,k as M,l as B,m as D,n as Q}from"./vendor.4c5ca304.js";const V=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};V();const F={setup(e){return(t,n)=>(l(),A(I(U)))}};var y=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n};const j={props:{buttonText:String},methods:{},data(){return{}}},O={class:"interactBtn"};function z(e,t,n,i,s,a){return l(),u("button",O,d(n.buttonText),1)}var E=y(j,[["render",z],["__scopeId","data-v-12b1c8a2"]]);const H={components:{GreenButton:E},methods:{buttonRedirect:function(){localStorage.setItem("client_id_spotify",this.client_id),localStorage.setItem("client_secret_spotify",this.client_secret);var e={client_id:this.client_id,response_type:"code",redirect_uri:"http://localhost:3000/callback",state:Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2),scope:"user-read-private user-read-email app-remote-control streaming playlist-read-collaborative user-read-currently-playing user-library-read"},t=new URLSearchParams(e);window.location.href=`https://accounts.spotify.com/authorize?${t.toString()}`}},data(){return{client_id:"",client_secret:""}}},_=e=>(v("data-v-6a74e99c"),e=e(),T(),e),G={class:"wrapper"},K={class:"hello"},W=_(()=>r("h1",null,"Mini Player for Spotify",-1)),Y=_(()=>r("br",null,null,-1)),J={class:"textDiv"},X=_(()=>r("h3",null,"Project Description",-1)),Z=_(()=>r("hr",null,null,-1)),ee=_(()=>r("br",null,null,-1)),te=_(()=>r("p",null,"This Mini Player for Spotify allows the user to listen to control playback and queue tracks with minimal screen space. ",-1)),re=_(()=>r("br",null,null,-1)),se={class:"clientForm"},ne={class:"inputDiv"},ae=_(()=>r("label",{for:"clientId"},"Client ID",-1)),ie={class:"inputDiv"},oe=_(()=>r("label",{for:"clientSecret"},"Client Secret",-1));function le(e,t,n,i,s,a){const o=k("green-button");return l(),u("div",G,[r("div",K,[W,Y,r("div",J,[X,Z,ee,te,re,r("form",{onSubmit:t[2]||(t[2]=N(()=>{},["prevent"]))},[r("div",se,[r("div",ne,[ae,b(r("input",{type:"text",name:"clientID","onUpdate:modelValue":t[0]||(t[0]=f=>s.client_id=f),placeholder:"Client ID..."},null,512),[[S,s.client_id]])]),r("div",ie,[oe,b(r("input",{type:"text",name:"clientSecret","onUpdate:modelValue":t[1]||(t[1]=f=>s.client_secret=f),placeholder:"Client secret..."},null,512),[[S,s.client_secret]])])])],32),x(o,{buttonText:"Continue",onClick:a.buttonRedirect},null,8,["onClick"])])])])}var ce=y(H,[["render",le],["__scopeId","data-v-6a74e99c"]]);const ue={methods:{},data(){return{code:"",state:"",client_id:"",client_secret:"",signedIn:null}},mounted(){this.client_id=localStorage.getItem("client_id_spotify"),this.client_secret=localStorage.getItem("client_secret_spotify");var e=window.location.search,t=new URLSearchParams(e);this.code=t.get("code"),this.state=t.get("state"),console.log(this.code),console.log(this.state);var n=new URLSearchParams({grant_type:"authorization_code",code:this.code,redirect_uri:"http://localhost:3000/callback",show_dialog:!0}),i={headers:{Authorization:`Basic ${btoa(this.client_id+":"+this.client_secret)}`,"Content-Type":"application/x-www-form-urlencoded"}};m.post("https://accounts.spotify.com/api/token",n.toString(),i).then(s=>{this.signedIn=!0,console.log(s),localStorage.setItem("spotifyToken",s.data.access_token),localStorage.setItem("refreshSpotifyToken",s.data.refresh_token),window.open("http://localhost:3000/dashboard","popup","width=320,height=700")}).catch(()=>{this.signedIn=!1})}},de={key:0},pe=r("h1",null,"Signed In",-1),_e=[pe],he={key:1},me=r("h1",null,"Error Occured",-1),ye=r("button",null,"Go Home",-1);function ge(e,t,n,i,s,a){const o=k("RouterLink");return l(),u("div",null,[s.signedIn?(l(),u("div",de,_e)):g("",!0),s.signedIn?g("",!0):(l(),u("div",he,[me,x(o,{to:"/"},{default:R(()=>[ye]),_:1})]))])}var fe=y(ue,[["render",ge]]);function ke(){var e=localStorage.get("refreshSpotifyToken");p.post("/api/token",{grant_type:"refresh_token",refresh_token:e}).then(t=>{console.log(t),localStorage.setItem("spotifyToken",t.data.access_token)})}const p=m.create({baseURL:"https://api.spotify.com/v1/",headers:{Authorization:`Bearer ${localStorage.getItem("spotifyToken")}`,"Content-Type":"application/json"}});p.interceptors.response.use(function(e){return e},function(e){return e.response.status==401?(ke(),p.request(e.config)):Promise.reject(e)});var ve={pausePlayback(){return p.put("me/player/pause")},startPlayback(){return p.put("me/player/play")},skipTrack(){return p.post("me/player/next")},previousTrack(){return p.post("me/player/previous")},setTrackTime(e){return p.put(`me/player/seek?position_ms=${e}`)},playSelectedTrack(e){p.post(`me/player/queue?uri=spotify:track:${e}`).then(t=>{this.skipTrack()})},getCurrentTrack(){return p.get("me/player/currently-playing").then(e=>e.data).catch(()=>null)}},Te={getPlaylistFirstTrack(e){p.get(`playlists/${e}/tracks?limit=1`).then(t=>t.data.items[0])},getPlaylists(){var e=[];return p.get("me/playlists").then(t=>{var n=t.data.items;n.map(i=>{e.push({id:i.id,name:i.name,owner:i.owner.display_name,coverArtUrl:i.images[0].url})})}),e}},h={player:ve,playlists:Te};const be={methods:{msToTime:function(e){var t=Math.floor(e/1e3%60),n=Math.floor(e/1e3/60%60);return t<10?`${n}:0${t}`:`${n}:${t}`},pausePlayback:function(){h.player.pausePlayback()},startPlayback:function(){h.player.startPlayback()},skipTrack:function(){h.player.skipTrack()},previousTrack:function(){h.player.previousTrack()},setTrackTime:function(){h.player.setTrackTime(this.$refs.trackProgressBar.value)}},data(){return{rangeSliderValue:this.getRangeValue}},props:{currentSongName:String,currentSongArtist:String,currentCoverArt:String,currentAlbumName:String,explicit:Boolean,playing:Boolean,currentTrackLength:Number,currentTrackTime:Number},computed:{getCurrentTrackTime(){return this.msToTime(this.currentTrackTime)},getCurrentTrackLength(){return this.msToTime(this.currentTrackLength)},bgImageStyle(){return console.log(this.currentCoverArt),{"background-image":`url (${this.currentCoverArt})`}}}},Se=e=>(v("data-v-69eafcb3"),e=e(),T(),e),xe=Se(()=>r("link",{href:"https://fonts.googleapis.com/icon?family=Material+Icons",rel:"stylesheet"},null,-1)),Ce={class:"wrapper"},Pe={ref:"albumImageElement",class:"albumDiv"},$e=["src"],we={class:"playbackControl"},Ae={class:"timeTrack"},Le=["max","value"],Ie={class:"trackMeta"},Ue={class:"nameArtist"},Ne={class:"nameExplicit"},Re={class:"trackName"},qe={key:0,class:"material-icons explicit"},Me={class:"trackName"};function Be(e,t,n,i,s,a){return l(),u(C,null,[xe,r("div",Ce,[r("div",Pe,[r("img",{src:n.currentCoverArt,alt:""},null,8,$e)],512),r("div",we,[r("div",Ae,[r("span",null,d(this.getCurrentTrackTime),1),r("input",{onChange:t[0]||(t[0]=(...o)=>a.setTrackTime&&a.setTrackTime(...o)),type:"range",ref:"trackProgressBar",class:"trackTime",name:"trackProgress",min:"0",max:n.currentTrackLength,value:n.currentTrackTime,step:"1000"},null,40,Le),r("span",null,d(this.getCurrentTrackLength),1)]),r("div",null,[r("span",{class:"buttonControl material-icons",onClick:t[1]||(t[1]=(...o)=>a.previousTrack&&a.previousTrack(...o))},"skip_previous"),n.playing?(l(),u("span",{key:0,class:"buttonControl material-icons",onClick:t[2]||(t[2]=(...o)=>a.pausePlayback&&a.pausePlayback(...o))},"pause_circle_filled")):g("",!0),n.playing?g("",!0):(l(),u("span",{key:1,class:"buttonControl material-icons",onClick:t[3]||(t[3]=(...o)=>a.startPlayback&&a.startPlayback(...o))},"play_arrow")),r("span",{class:"buttonControl material-icons",onClick:t[4]||(t[4]=(...o)=>a.skipTrack&&a.skipTrack(...o))},"skip_next")]),r("div",Ie,[r("div",Ue,[r("div",Ne,[r("p",Re,d(n.currentSongName),1),n.explicit?(l(),u("span",qe,"explicit")):g("",!0)]),r("p",null,"by "+d(n.currentSongArtist),1)]),r("div",Me,[r("p",null,d(n.currentAlbumName),1)])])])])],64)}var De=y(be,[["render",Be],["__scopeId","data-v-69eafcb3"]]),Qe="/assets/Spotify_Icon_RGB_White.608bf92e.png";const Ve={emits:["play-selected-track","add-to-queue"],props:{title:String,artist:String,album:String,coverArtUrl:String,id:String},methods:{}},P=e=>(v("data-v-e88e1b26"),e=e(),T(),e),Fe=P(()=>r("link",{href:"https://fonts.googleapis.com/icon?family=Material+Icons",rel:"stylesheet"},null,-1)),je={class:"smallTrack"},Oe=P(()=>r("img",{src:Qe,style:{height:"22px",width:"22px","margin-right":"8px"},alt:""},null,-1)),ze={class:"trackData"},Ee=P(()=>r("span",{class:"material-icons"},"play_arrow",-1)),He=["src"],Ge={class:"smallTrackData"},Ke={class:"title"},We={class:"artistAndAlbum"},Ye={class:"addToQueue"};function Je(e,t,n,i,s,a){return l(),u(C,null,[Fe,r("div",je,[Oe,r("div",ze,[r("div",{class:"albumArt",onClick:t[0]||(t[0]=o=>e.$emit("play-selected-track",n.id))},[Ee,r("img",{src:n.coverArtUrl,width:"50",height:"50",alt:""},null,8,He)]),r("div",Ge,[r("span",Ke,d(n.title),1),r("span",We,d(n.artist)+" - "+d(n.album),1)])]),r("div",Ye,[r("span",{onClick:t[1]||(t[1]=o=>e.$emit("add-to-queue",n.id)),class:"material-icons"},"queue")])])],64)}var L=y(Ve,[["render",Je],["__scopeId","data-v-e88e1b26"]]);const Xe={emits:["select-playlist"],components:{SmallTrack:L},props:{coverURL:String,name:String,owner:String,id:String}},Ze=["src"],et={class:"info"},tt={style:{"font-weight":"600"}};function rt(e,t,n,i,s,a){return l(),u("div",{onClick:t[0]||(t[0]=o=>e.$emit("select-playlist",n.id,n.name)),class:"playlist"},[r("img",{src:n.coverURL,alt:"playlist image"},null,8,Ze),r("div",et,[r("p",tt,d(n.name),1),r("p",null,"By "+d(n.owner),1)])])}var st=y(Xe,[["render",rt],["__scopeId","data-v-5eb098ae"]]);const nt={components:{Player:De,SmallTrack:L,Playlist:st},methods:{filterList:function(){},getPlaylistFirstTrack:function(e){return h.playlists.getPlaylistFirstTrack(e)},selectPlaylist:function(e,t){t!=this.playlistName&&(this.playlistName=t,this.playlistURL=`https://open.spotify.com/playlist/${e}`,this.queueTracks=[],this.generateQueue(this.getPlaylistFirstTrack(e)))},addToQueue:function(e){m.post(`/v1/me/player/queue?uri=spotify:track:${e}`).then(t=>{this.$refs.queuePopUp.classList+=" queuePopUp-show",setTimeout(()=>{this.$refs.queuePopUp.classList.remove("queuePopUp-show")},2e3)})},playSelectedTrack:function(e){h.player.playSelectedTrack(e)},getPlaylists:function(){this.playlists=h.playlists.getPlaylists(),console.log(this.playlists)},generateQueue:function(e){m.get(e).then(t=>{var n=this.isPlaylist?t.data.tracks.items:t.data.items;n.map(i=>{this.queueTracks.push({id:i.track.id,name:i.track.name,artist:i.track.artists[0].name,album:i.track.album.name,coverArtUrl:i.track.album.images[2].url})}),this.nextUrlContext=this.isPlaylist?t.data.tracks.next:t.data.next})},loadMore:function(){this.nextUrlContext&&this.generateQueue(this.nextUrlContext)},getCurrentTrack:async function(){var e=await h.player.getCurrentTrack();if(!!e&&(this.currentTrackTime=e.progress_ms,this.currentTrackLength=e.item.duration_ms,this.currentSongName=e.item.name,this.currentSongArtist=e.item.artists[0].name,this.currentAlbumName=e.item.album.name,this.currentCoverArt=e.item.album.images[0].url,this.currentSongId=e.item.id,this.explicit=e.item.explicit,this.playing=e.is_playing,this.isPlaylist=!!e.context,!(this.playlistName=="Your Library"&&e.context==null))){try{if(this.playlistURL==e.context.href)return}catch{}this.queueTracks=[],this.isPlaylist?m.get(e.context.href).then(t=>{this.playlistURL=t.data.href,this.playlistName=t.data.name,this.nextUrlContext=this.playlistURL,this.generateQueue(this.nextUrlContext)}):(this.playlistName="Your Library",this.nextUrlContext="/v1/me/tracks",this.generateQueue(this.nextUrlContext))}},refreshTrack:function(){setInterval(this.getCurrentTrack,1e3)}},data(){return{accessToken:localStorage.getItem("spotifyToken"),refreshToken:localStorage.getItem("refreshSpotifyToken"),currentSongName:null,currentSongArtist:null,currentAlbumName:null,currentCoverArt:null,currentSongId:null,explicit:!1,playing:!1,playlists:[],currentTrackLength:0,currentTrackTime:0,isPlaylist:!1,playlistName:"",playlistURL:"",nextUrlContext:"",allSongs:[],queueTracks:[],searchQuery:""}},mounted(){m.defaults.baseURL="https://api.spotify.com",m.defaults.headers.common.Authorization=`Bearer ${this.accessToken}`,m.defaults.headers.common["Content-Type"]="application/json",this.getCurrentTrack(),this.refreshTrack()}},$=e=>(v("data-v-5188eecc"),e=e(),T(),e),at={class:"wrapper"},it={ref:"queuePopUp",class:"queuePopUp"},ot=$(()=>r("p",null,"Added to queue!",-1)),lt=[ot],ct={class:"queuedSongs"},ut={class:"searchDiv"},dt=$(()=>r("span",{class:"material-icons"},"search",-1)),pt=$(()=>r("hr",null,null,-1)),_t={class:"trackList"};function ht(e,t,n,i,s,a){const o=k("player"),f=k("small-track");return l(),u("div",at,[r("div",it,lt,512),x(o,{ref:"playerComponent",currentSongName:s.currentSongName,currentSongArtist:s.currentSongArtist,currentAlbumName:s.currentAlbumName,currentCoverArt:s.currentCoverArt,explicit:s.explicit,playing:s.playing,currentTrackLength:s.currentTrackLength,currentTrackTime:s.currentTrackTime},null,8,["currentSongName","currentSongArtist","currentAlbumName","currentCoverArt","explicit","playing","currentTrackLength","currentTrackTime"]),r("div",ct,[r("h2",null,d(s.playlistName),1),r("div",ut,[dt,b(r("input",{class:"searchInput",type:"text",onKeyup:t[0]||(t[0]=(...c)=>a.filterList&&a.filterList(...c)),"onUpdate:modelValue":t[1]||(t[1]=c=>s.searchQuery=c),placeholder:"Type search here..."},null,544),[[S,s.searchQuery]])]),pt,r("ul",_t,[(l(!0),u(C,null,q(s.queueTracks,c=>(l(),u("li",{key:c.id},[c.name.toLowerCase().includes(s.searchQuery.toLowerCase())||c.artist.toLowerCase().includes(s.searchQuery.toLowerCase())||s.searchQuery.length==0?(l(),A(f,{key:0,title:c.name,artist:c.artist,album:c.album,coverArtUrl:c.coverArtUrl,id:c.id,onPlaySelectedTrack:a.playSelectedTrack,onAddToQueue:a.addToQueue},null,8,["title","artist","album","coverArtUrl","id","onPlaySelectedTrack","onAddToQueue"])):g("",!0)]))),128))]),r("span",{onClick:t[2]||(t[2]=(...c)=>a.loadMore&&a.loadMore(...c)),class:"loadMore"},"Load More")])])}var mt=y(nt,[["render",ht],["__scopeId","data-v-5188eecc"]]);const yt=M({history:B("/"),routes:[{path:"/",name:"Home",component:ce},{path:"/callback",name:"callback",component:fe},{path:"/dashboard",name:"dashboard",component:mt}]}),w=D(F);w.use(Q());w.use(yt);w.mount("#app");
